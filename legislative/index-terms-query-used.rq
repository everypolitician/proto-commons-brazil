SELECT DISTINCT
  ?house ?houseLabel
  ?legislature ?legislatureLabel
  ?term ?termLabel
  ?termStart ?termEnd
  ?termSpecificPosition
WHERE {
  VALUES (?house ?position) {
    (wd:Q1834804 wd:Q20058725)
    (wd:Q2119413 wd:Q18964326)
    (wd:Q10262893 wd:Q53864942)
    (wd:Q12243888 wd:Q53864924)
    (wd:Q12270300 wd:Q53864938)
    (wd:Q12469964 wd:Q53864931)
    (wd:Q13163502 wd:Q53864930)
    (wd:Q16142313 wd:Q53864939)
    (wd:Q16142333 wd:Q53864947)
    (wd:Q16494759 wd:Q53864941)
    (wd:Q16494760 wd:Q53864945)
    (wd:Q16498710 wd:Q53864940)
    (wd:Q4808730 wd:Q53864923)
    (wd:Q6518202 wd:Q53864935)
    (wd:Q6583209 wd:Q53864925)
    (wd:Q9633173 wd:Q53864936)
    (wd:Q9633175 wd:Q53864926)
    (wd:Q9633183 wd:Q53864934)
    (wd:Q9633190 wd:Q53864943)
    (wd:Q9633197 wd:Q53864929)
    (wd:Q9633200 wd:Q53864949)
    (wd:Q9633202 wd:Q53864944)
    (wd:Q9633207 wd:Q53864932)
    (wd:Q9633212 wd:Q53864948)
    (wd:Q9633218 wd:Q53864937)
    (wd:Q9633221 wd:Q53864933)
    (wd:Q9633230 wd:Q53864928)
    (wd:Q9633239 wd:Q53864927)
    (wd:Q9633245 wd:Q53864946)
    (wd:Q10262910 wd:Q56459777)
    (wd:Q10262911 wd:Q56459751)
    (wd:Q10262914 wd:Q56459844)
    (wd:Q10262915 wd:Q56459767)
    (wd:Q10262916 wd:Q56459811)
    (wd:Q18280688 wd:Q56459791)
    (wd:Q18465408 wd:Q56459772)
    (wd:Q18465412 wd:Q56459756)
    (wd:Q20045706 wd:Q56459770)
    (wd:Q20052907 wd:Q56459817)
    (wd:Q25418761 wd:Q56459752)
    (wd:Q25443954 wd:Q56459808)
    (wd:Q30930077 wd:Q56459761)
    (wd:Q53934974 wd:Q53935627)
    (wd:Q53934976 wd:Q53935633)
    (wd:Q53934977 wd:Q53935638)
    (wd:Q53934979 wd:Q53935641)
    (wd:Q53934981 wd:Q53934982)
    (wd:Q53934998 wd:Q53935000)
    (wd:Q53935004 wd:Q53935007)
    (wd:Q53935013 wd:Q53935014)
    (wd:Q53935035 wd:Q53935038)
    (wd:Q53935043 wd:Q53935045)
    (wd:Q53935048 wd:Q53935050)
    (wd:Q53935073 wd:Q53935075)
    (wd:Q56349614 wd:Q56459763)
    (wd:Q56450220 wd:Q56459748)
    (wd:Q56450221 wd:Q56459749)
    (wd:Q56450222 wd:Q56459750)
    (wd:Q56450223 wd:Q56459753)
    (wd:Q56450224 wd:Q56459754)
    (wd:Q56450225 wd:Q56459755)
    (wd:Q56450226 wd:Q56459759)
    (wd:Q56450228 wd:Q56459760)
    (wd:Q56450229 wd:Q56459762)
    (wd:Q56450232 wd:Q56459764)
    (wd:Q56450233 wd:Q56459766)
    (wd:Q56450234 wd:Q56459768)
    (wd:Q56450235 wd:Q56459769)
    (wd:Q56450236 wd:Q56459771)
    (wd:Q56450237 wd:Q56459773)
    (wd:Q56450238 wd:Q56459774)
    (wd:Q56450239 wd:Q56459775)
    (wd:Q56450240 wd:Q56459776)
    (wd:Q56450243 wd:Q56459779)
    (wd:Q56450244 wd:Q56459780)
    (wd:Q56450246 wd:Q56459782)
    (wd:Q56450247 wd:Q56459783)
    (wd:Q56450249 wd:Q56459784)
    (wd:Q56450250 wd:Q56459785)
    (wd:Q56450251 wd:Q56459786)
    (wd:Q56450252 wd:Q56459787)
    (wd:Q56450253 wd:Q56459788)
    (wd:Q56450254 wd:Q56459790)
    (wd:Q56450255 wd:Q56459793)
    (wd:Q56450256 wd:Q56459794)
    (wd:Q56450257 wd:Q56459795)
    (wd:Q56450258 wd:Q56459796)
    (wd:Q56450259 wd:Q56459797)
    (wd:Q56450260 wd:Q56459798)
    (wd:Q56450261 wd:Q56459799)
    (wd:Q56450262 wd:Q56459800)
    (wd:Q56450265 wd:Q56459801)
    (wd:Q56450266 wd:Q56459802)
    (wd:Q56450267 wd:Q56459803)
    (wd:Q56450268 wd:Q56459804)
    (wd:Q56450269 wd:Q56459806)
    (wd:Q56450270 wd:Q56459807)
    (wd:Q56450271 wd:Q56459809)
    (wd:Q56450272 wd:Q56459812)
    (wd:Q56450273 wd:Q56459813)
    (wd:Q56450274 wd:Q56459815)
    (wd:Q56450275 wd:Q56459816)
    (wd:Q56450276 wd:Q56459818)
    (wd:Q56450277 wd:Q56459819)
    (wd:Q56450278 wd:Q56459820)
    (wd:Q56450279 wd:Q56459822)
    (wd:Q56450280 wd:Q56459823)
    (wd:Q56450281 wd:Q56459824)
    (wd:Q56450282 wd:Q56459825)
    (wd:Q56450285 wd:Q56459827)
    (wd:Q56450286 wd:Q56459828)
    (wd:Q56450287 wd:Q56459829)
    (wd:Q56450288 wd:Q56459830)
    (wd:Q56450289 wd:Q56459831)
    (wd:Q56450290 wd:Q56459834)
    (wd:Q56450291 wd:Q56459835)
    (wd:Q56450292 wd:Q56459836)
    (wd:Q56450293 wd:Q56459837)
    (wd:Q56450295 wd:Q56459838)
    (wd:Q56450296 wd:Q56459839)
    (wd:Q56450298 wd:Q56459840)
    (wd:Q56450299 wd:Q56459841)
    (wd:Q56450300 wd:Q56459842)
    (wd:Q56450301 wd:Q56459845)
    (wd:Q56450302 wd:Q56459846)
    (wd:Q56450303 wd:Q56459847)
    (wd:Q56450304 wd:Q56459848)
    (wd:Q56450306 wd:Q56459850)
    (wd:Q56450307 wd:Q56459851)
    (wd:Q56450308 wd:Q56459853)
    (wd:Q56450309 wd:Q56459854)
    (wd:Q56450310 wd:Q56459855)
    (wd:Q6936214 wd:Q53934881)
    (wd:Q6936217 wd:Q53934877)
    (wd:Q56450305 wd:Q56459849)
    (wd:Q56450311 wd:Q56459856)
    (wd:Q56450313 wd:Q56459857)
    (wd:Q56450314 wd:Q56459858)
  }
  ?house (p:P361/ps:P361)* ?legislature .
      ?baseTerm p:P31|p:P279 [ ps:P279|ps:P31 wd:Q15238777 ; pq:P642 ?legislature ] .
      OPTIONAL { ?subTerm wdt:P31 ?baseTerm }

  BIND(COALESCE(?subTerm, ?baseTerm) AS ?term)

  OPTIONAL { ?term (wdt:P580|wdt:P571) ?termStart. }
  OPTIONAL { ?term (wdt:P582|wdt:P576) ?termEnd. }
  OPTIONAL { ?term (wdt:P155|wdt:P1365) ?termReplaces }
  OPTIONAL { ?term (wdt:P156|wdt:P1366) ?termReplacedBy }
  OPTIONAL {
    ?termSpecificPosition wdt:P31/wdt:P279* wd:Q4164871 ;
                          p:P279 [ ps:P279 ?position ;
                                   pq:P2937 ?term ] .
  }

  FILTER (!BOUND(?termEnd) || ?termEnd > NOW())
  FILTER (!BOUND(?termReplacedBy))
  SERVICE wikibase:label { bd:serviceParam wikibase:language "en,pt-br,pt". }
} ORDER BY ?termStart ?term
